{"ast":null,"code":"import _objectSpread from\"/home/project/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useCallback,useState}from'react';import{useDropzone}from'react-dropzone';import{Upload,X,Search}from'lucide-react';import axios from'axios';import'./ImageUpload.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ImageUpload=_ref=>{let{onSearchStart,onSearchComplete,onSearchEnd,loading,onReset}=_ref;const[selectedFile,setSelectedFile]=useState(null);const[previewUrl,setPreviewUrl]=useState(null);const[error,setError]=useState(null);const onDrop=useCallback(acceptedFiles=>{const file=acceptedFiles[0];if(file){setSelectedFile(file);setPreviewUrl(URL.createObjectURL(file));setError(null);}},[]);const{getRootProps,getInputProps,isDragActive}=useDropzone({onDrop,accept:{'image/*':['.jpeg','.jpg','.png','.gif','.bmp']},multiple:false,maxSize:10*1024*1024// 10MB\n});const handleSearch=async()=>{if(!selectedFile)return;onSearchStart();setError(null);const formData=new FormData();formData.append('file',selectedFile);try{const response=await axios.post('/match',formData,{headers:{'Content-Type':'multipart/form-data'},timeout:30000// 30 seconds timeout\n});onSearchComplete(response.data,previewUrl);}catch(err){var _err$response,_err$response$data;console.error('Search error:',err);setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.detail)||err.message||'Failed to search for similar furniture. Please try again.');}finally{onSearchEnd();}};const handleReset=()=>{setSelectedFile(null);setPreviewUrl(null);setError(null);onReset();};return/*#__PURE__*/_jsx(\"div\",{className:\"upload-section card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"upload-content\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Upload Furniture Image\"}),!previewUrl?/*#__PURE__*/_jsxs(\"div\",_objectSpread(_objectSpread({},getRootProps()),{},{className:\"dropzone \".concat(isDragActive?'active':''),children:[/*#__PURE__*/_jsx(\"input\",_objectSpread({},getInputProps())),/*#__PURE__*/_jsx(Upload,{className:\"upload-icon\"}),/*#__PURE__*/_jsx(\"p\",{className:\"upload-text\",children:isDragActive?'Drop the image here...':'Drag & drop an image here, or click to select'}),/*#__PURE__*/_jsx(\"p\",{className:\"upload-hint\",children:\"Supports JPG, PNG, GIF up to 10MB\"})]})):/*#__PURE__*/_jsxs(\"div\",{className:\"preview-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"preview-container\",children:[/*#__PURE__*/_jsx(\"img\",{src:previewUrl,alt:\"Preview\",className:\"preview-image\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleReset,className:\"remove-btn\",type:\"button\",children:/*#__PURE__*/_jsx(X,{size:16})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"action-buttons\",children:/*#__PURE__*/_jsx(\"button\",{onClick:handleSearch,disabled:loading,className:\"btn btn-primary search-btn\",children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),\"Searching...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Search,{size:20}),\"Find Similar Furniture\"]})})})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:/*#__PURE__*/_jsx(\"p\",{children:error})})]})});};export default ImageUpload;","map":{"version":3,"names":["React","useCallback","useState","useDropzone","Upload","X","Search","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ImageUpload","_ref","onSearchStart","onSearchComplete","onSearchEnd","loading","onReset","selectedFile","setSelectedFile","previewUrl","setPreviewUrl","error","setError","onDrop","acceptedFiles","file","URL","createObjectURL","getRootProps","getInputProps","isDragActive","accept","multiple","maxSize","handleSearch","formData","FormData","append","response","post","headers","timeout","data","err","_err$response","_err$response$data","console","detail","message","handleReset","className","children","_objectSpread","concat","src","alt","onClick","type","size","disabled"],"sources":["/home/project/src/components/ImageUpload.js"],"sourcesContent":["import React, { useCallback, useState } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { Upload, X, Search } from 'lucide-react';\nimport axios from 'axios';\nimport './ImageUpload.css';\n\nconst ImageUpload = ({ onSearchStart, onSearchComplete, onSearchEnd, loading, onReset }) => {\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [previewUrl, setPreviewUrl] = useState(null);\n  const [error, setError] = useState(null);\n\n  const onDrop = useCallback((acceptedFiles) => {\n    const file = acceptedFiles[0];\n    if (file) {\n      setSelectedFile(file);\n      setPreviewUrl(URL.createObjectURL(file));\n      setError(null);\n    }\n  }, []);\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    accept: {\n      'image/*': ['.jpeg', '.jpg', '.png', '.gif', '.bmp']\n    },\n    multiple: false,\n    maxSize: 10 * 1024 * 1024 // 10MB\n  });\n\n  const handleSearch = async () => {\n    if (!selectedFile) return;\n\n    onSearchStart();\n    setError(null);\n\n    const formData = new FormData();\n    formData.append('file', selectedFile);\n\n    try {\n      const response = await axios.post('/match', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n        },\n        timeout: 30000 // 30 seconds timeout\n      });\n\n      onSearchComplete(response.data, previewUrl);\n    } catch (err) {\n      console.error('Search error:', err);\n      setError(\n        err.response?.data?.detail || \n        err.message || \n        'Failed to search for similar furniture. Please try again.'\n      );\n    } finally {\n      onSearchEnd();\n    }\n  };\n\n  const handleReset = () => {\n    setSelectedFile(null);\n    setPreviewUrl(null);\n    setError(null);\n    onReset();\n  };\n\n  return (\n    <div className=\"upload-section card\">\n      <div className=\"upload-content\">\n        <h2>Upload Furniture Image</h2>\n        \n        {!previewUrl ? (\n          <div\n            {...getRootProps()}\n            className={`dropzone ${isDragActive ? 'active' : ''}`}\n          >\n            <input {...getInputProps()} />\n            <Upload className=\"upload-icon\" />\n            <p className=\"upload-text\">\n              {isDragActive\n                ? 'Drop the image here...'\n                : 'Drag & drop an image here, or click to select'}\n            </p>\n            <p className=\"upload-hint\">\n              Supports JPG, PNG, GIF up to 10MB\n            </p>\n          </div>\n        ) : (\n          <div className=\"preview-section\">\n            <div className=\"preview-container\">\n              <img src={previewUrl} alt=\"Preview\" className=\"preview-image\" />\n              <button\n                onClick={handleReset}\n                className=\"remove-btn\"\n                type=\"button\"\n              >\n                <X size={16} />\n              </button>\n            </div>\n            \n            <div className=\"action-buttons\">\n              <button\n                onClick={handleSearch}\n                disabled={loading}\n                className=\"btn btn-primary search-btn\"\n              >\n                {loading ? (\n                  <>\n                    <div className=\"loading-spinner\"></div>\n                    Searching...\n                  </>\n                ) : (\n                  <>\n                    <Search size={20} />\n                    Find Similar Furniture\n                  </>\n                )}\n              </button>\n            </div>\n          </div>\n        )}\n\n        {error && (\n          <div className=\"error-message\">\n            <p>{error}</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default ImageUpload;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}